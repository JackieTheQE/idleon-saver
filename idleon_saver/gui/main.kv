#:kivy 2.0.0
#:import hex kivy.utils.get_color_from_hex

<BackgroundColor@Widget>:
    background_normal: ''
    background_color: hex("#1F2933")
    canvas.before:
        Color:
            rgba: (1, 1, 1, 1) if root.background_color is None else root.background_color
        Rectangle:
            size: self.size
            pos: self.pos

<Header@Widget>:
    size_hint_y: None
    height: 20

<ButtonBox@BoxLayout>:
    size_hint_y: None
    height: 30

<VBox@BoxLayout>:
    orientation: 'vertical'
    padding: [10]
    spacing: 5

<Info@Label+BackgroundColor>:
    background_color: hex("#3E4C59")
    size: self.texture_size
    size_hint_y: None
    padding: [10, 5]
    text_size: root.width, None
    font_size: 18

<Button>:
    background_normal: ''
    background_color: hex("#52606D")
    size: 120, 30
    size_hint: None, None
    font_size: 18

<MainWindow>:
    background_normal: ''
    canvas.before:
        Color:
            rgba: hex("#1F2933")
        Rectangle:
            pos: self.pos
            size: self.size

<ErrorDialog@VBox>:
    Header:

    Info:
        halign: "justify"
        text: "Oops! I couldn't find the right file. Check the path and try again.\nIf you keep getting this error, please report it on GitHub with your log file attached."

    Widget:

    ButtonBox:
        Button:
            text: "Open Logs"
            on_release: root.open_logs()

        Widget:

        Button:
            text: "Open GitHub"
            on_release: root.open_github()

        Widget:

        Button:
            text: "Done"
            on_release: root.done()

<FileChooserDialog@VBox>:
    FileChooserListView:
        id: filechooser
        filters: root.filters
        on_submit: root.done(filechooser.path, filechooser.selection)

    ButtonBox:
        Button:
            text: "Cancel"
            on_release: root.cancel()

        Widget:

        Button:
            text: "Done"
            on_release: root.done(filechooser.path, filechooser.selection)

<StartScreen>:
    VBox:
        Header:

        Info:
            text: "Welcome to Idleon Saver! This tool will:\n\n  1. open Legends of Idleon,\n  2. save your data to a file on your computer, and\n  3. process that data to create a file ready for import into Idleon Companion.\n\nThis all takes place on your computer; this app does not collect any data.\nTo get started, click Next!"

        Widget:

        ButtonBox:
            Button:
                id: back
                text: 'Exit'
                on_release:
                    app.stop()

            Widget:

            Button:
                id: next
                text: 'Next'
                on_release:
                    root.manager.transition.direction = 'left'
                    root.manager.current = root.manager.next()

<EndScreen>:
    VBox:
        Header:

        Info:
            text: "Thanks for using Idleon Saver!\n\nYour data has been saved to decoded_plain.json in the same place as your idleonsave.txt."

        Widget:

        ButtonBox:
            Button:
                id: back
                text: 'Back'
                on_release:
                    root.manager.transition.direction = 'right'
                    root.manager.current = root.manager.previous()

            Widget:

            Button:
                id: next
                text: 'Finish'
                on_release:
                    app.stop()

<PathScreen>:
    back: back
    next: next
    error: error
    path_input: path_input

    VBox:
        Header:

        Info:
            id: caption
            text: root.caption

        ButtonBox:
            TextInput:
                id: path_input
                size_hint_y: None
                font_size: 16
                height: 30
                multiline: False
                on_text: root.on_path_text(args[1])
                text: root.default_path

            Button:
                text: 'Browse'
                on_release: root.show_filebrowser()

        Info:
            id: error
            background_color: hex("#B71C1C")

        Widget:

        ButtonBox:
            size_hint_y: None

            Button:
                id: back
                text: 'Back'
                on_release:
                    root.manager.transition.direction = 'right'
                    root.manager.current = root.manager.previous()

            Widget:

            Button:
                id: next
                text: 'Next'
                on_release:
                    root.try_action(root.path_input.text)
